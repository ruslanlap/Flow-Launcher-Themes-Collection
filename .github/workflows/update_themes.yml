name: ğŸ§  Weekly Flow Launcher Theme Sync

on:
  schedule:
    - cron: '0 0 * * 0'  # â° Ğ©Ğ¾Ğ½ĞµĞ´Ñ–Ğ»Ñ– Ğ¾ 00:00 UTC
  workflow_dispatch:     # ğŸ– Ğ ÑƒÑ‡Ğ½Ğ¸Ğ¹ Ğ·Ğ°Ğ¿ÑƒÑĞº

jobs:
  update:
    name: ğŸ”„ Fetch & Update Themes
    runs-on: ubuntu-latest
    permissions:
      contents: write  # ğŸ”‘ ĞĞµĞ¾Ğ±Ñ…Ñ–Ğ´Ğ½Ğ¾ Ğ´Ğ»Ñ Ğ¿ÑƒÑˆĞ° Ğ·Ğ¼Ñ–Ğ½

    steps:
      - name: ğŸ“¦ Checkout Repository
        uses: actions/checkout@v4
        with:
          fetch-depth: 0  # ğŸ“š ĞÑ‚Ñ€Ğ¸Ğ¼Ğ°Ñ‚Ğ¸ Ğ¿Ğ¾Ğ²Ğ½Ñƒ Ñ–ÑÑ‚Ğ¾Ñ€Ñ–Ñ ĞºĞ¾Ğ¼Ñ–Ñ‚Ñ–Ğ²

      - name: ğŸ Set Up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'  # ğŸ¯ ĞšĞ¾Ğ½ĞºÑ€ĞµÑ‚Ğ½Ğ° Ğ²ĞµÑ€ÑÑ–Ñ Python

      - name: ğŸ“¥ Install Dependencies
        run: pip install requests

      - name: ğŸ“¡ Run Theme Sync Script
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}  # ğŸ”’ Ğ’Ğ¸ĞºĞ¾Ñ€Ğ¸ÑÑ‚Ğ¾Ğ²ÑƒÑ”Ğ¼Ğ¾ Ğ²Ğ±ÑƒĞ´Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğ¹ Ñ‚Ğ¾ĞºĞµĞ½
        run: python update_themes.py

      - name: ğŸ’¾ Commit & Push Changes
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        run: |
          git config --global user.name "Theme Sync Bot ğŸ¤–"
          git config --global user.email "actions@github.com"
          
          # ğŸ”„ Ğ¡Ğ¸Ğ½Ñ…Ñ€Ğ¾Ğ½Ñ–Ğ·Ğ°Ñ†Ñ–Ñ Ğ· upstream
          git pull --rebase origin main
          
          git add README.md
          git diff-index --quiet HEAD || {
            git commit -m "ğŸ§µ Auto-update README with new themes âœ¨"
            git push origin HEAD:main
          }